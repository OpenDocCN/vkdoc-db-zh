["```\nCREATE OR REPLACE FUNCTION add_inverse(val1 double, val2 double)\nRETURNS NULL ON NULL INPUT\nRETURNS double LANGUAGE java\nAS '\nreturn (val1 == 0 || val2 == 0)\n? Double.NaN\n: (1/val1 + 1/val2);\n';\n```", "```\nCREATE TABLE test(v1 double PRIMARY KEY, v2 double);\nINSERT INTO test(v1, v2) VALUES (5, 7);\nINSERT INTO test(v1, v2) VALUES (2, 2);\nINSERT INTO test(v1) VALUES (9);\nINSERT INTO test(v1, v2) VALUES (7, 0);\nSELECT v1, v2, add_inverse(v1, v2) FROM test;\ncassandra@cqlsh:test> SELECT v1, v2, add_inverse(v1, v2) FROM test;\nv1 | v2   | test.add_inverse(v1, v2)\n----+------+--------------------------\n9 | null |                     null\n5 |    7 |                 0.342857\n2 |    2 |                        1\n7 |    0 |                      NaN\n```", "```\nCREATE OR REPLACE FUNCTION accumulate(integer[], integer) RETURNS integer[]\nAS 'select array[$1[1] + $2, $1[2] + 1];'\nLANGUAGE SQL\nIMMUTABLE\nRETURNS NULL ON NULL INPUT;\n```", "```\nCREATE OR REPLACE FUNCTION divide(integer[]) RETURNS float8\nAS 'select case when $1[2]=0 then 0 else $1[1]::float/$1[2] end;'\nLANGUAGE SQL\nIMMUTABLE\nRETURNS NULL ON NULL INPUT;\n```", "```\nCREATE OR REPLACE AGGREGATE alternative_avg(integer)\n(\nsfunc = accumulate,\nstype = integer[],\nfinalfunc = divide,\ninitcond = '{0, 0}'\n);\n```", "```\npostgres=# CREATE TABLE t(v INTEGER);\npostgres=# INSERT INTO t VALUES (3), (5), (9);\npostgres=# SELECT * FROM t;\nv\n---\n3\n5\n9\n(3 rows)\npostgres=# SELECT AVG(v), alternative_avg(v) FROM t;\navg         |  alternative_avg\n--------------------+-------------------\n5.6666666666666667 | 5.666666666666667\n(1 row)\n```", "```\nCREATE FUNCTION accumulate(acc tuple, val int)\nRETURNS NULL ON NULL INPUT\nRETURNS tuple\nLANGUAGE lua\nAS $$\nreturn { acc[1]+val, acc[2]+1 }\n$$;\nCREATE FUNCTION reduce(acc tuple, acc2 tuple)\nRETURNS NULL ON NULL INPUT\nRETURNS tuple\nLANGUAGE lua\nAS $$\nreturn { acc[1]+acc2[1], acc[2]+acc2[2] }\n$$;\nCREATE FUNCTION divide(acc tuple)\nRETURNS NULL ON NULL INPUT\nRETURNS double\nLANGUAGE lua\nAS $$\nreturn acc[1]/acc[2]\n$$;\nCREATE AGGREGATE alternative_avg(int)\nSFUNC accumulate\nSTYPE tuple\nREDUCEFUNC reduce\nFINALFUNC divide\nINITCOND (0, 0);\n```"]